<!DOCTYPE html>
<html dir="rtl" lang="he">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Jezy Fit</title>
<link rel="manifest" href="manifest.json"/>
</head>
<body>
<main>
<h1>Jezy Fit</h1>
<p>אפליקציית האימונים והתזונה שלך.</p>
</main>
<script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', function () {
      navigator.serviceWorker.register('sw.js').catch(function (err) {
        console.log('Service worker registration failed:', err);
      });
    });
  }
</script>

<script>
  const APP_VERSION = "2.0.0";

  function showUpdateBanner(newVersion) {
    const banner = document.createElement('div');
    banner.style.position = 'fixed';
    banner.style.bottom = '16px';
    banner.style.left = '50%';
    banner.style.transform = 'translateX(-50%)';
    banner.style.background = 'rgba(15,23,42,0.96)';
    banner.style.border = '1px solid rgba(34,197,94,0.7)';
    banner.style.borderRadius = '999px';
    banner.style.padding = '8px 14px';
    banner.style.display = 'flex';
    banner.style.alignItems = 'center';
    banner.style.gap = '10px';
    banner.style.zIndex = '9999';
    banner.style.boxShadow = '0 10px 30px rgba(0,0,0,0.6)';
    banner.style.fontSize = '13px';
    banner.style.color = '#e5e7eb';
    banner.style.direction = 'rtl';

    const text = document.createElement('span');
    text.textContent = "Jezy Fit עודכנה (גרסה " + newVersion + ") — לרענן?";

    const btn = document.createElement('button');
    btn.textContent = "רענן עכשיו";
    btn.style.border = 'none';
    btn.style.borderRadius = '999px';
    btn.style.padding = '6px 10px';
    btn.style.cursor = 'pointer';
    btn.style.fontSize = '12px';
    btn.style.background = 'linear-gradient(90deg,#22c55e,#16a34a)';
    btn.style.color = '#020617';
    btn.onclick = function () {
      banner.remove();
      window.location.reload();
    };

    const later = document.createElement('button');
    later.textContent = "אח\"כ";
    later.style.border = 'none';
    later.style.borderRadius = '999px';
    later.style.padding = '4px 9px';
    later.style.cursor = 'pointer';
    later.style.fontSize = '11px';
    later.style.background = 'rgba(31,41,55,0.9)';
    later.style.color = '#e5e7eb';
    later.onclick = function () {
      banner.remove();
    };

    banner.appendChild(text);
    banner.appendChild(btn);
    banner.appendChild(later);
    document.body.appendChild(banner);
  }

  document.addEventListener('DOMContentLoaded', function () {
    fetch('version.json', { cache: 'no-store' })
      .then(function (res) { return res.json(); })
      .then(function (data) {
        const newVersion = data.version;
        const stored = localStorage.getItem('appVersion');
        if (!stored) {
          localStorage.setItem('appVersion', newVersion);
        } else if (stored !== newVersion) {
          localStorage.setItem('appVersion', newVersion);
          showUpdateBanner(newVersion);
        }
      })
      .catch(function (e) {
        console.log('Version check failed', e);
      });
  });
</script>
</body>

</html>
